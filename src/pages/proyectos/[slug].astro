---
import PageLayout from "../../layouts/PageLayout.astro";
import FooterMV from "../../components/home/FooterMV.astro";
import { projects } from "../../data/projects";

export async function getStaticPaths() {
  return projects.map(p => ({ params: { slug: p.slug } }));
}

const { slug } = Astro.params;
const project = projects.find(p => p.slug === slug);
if (!project) throw new Error("Proyecto no encontrado");

const tone = project.area === "automatizacion" ? "yellow" : "blue";
const chipBg = tone === "yellow" ? "rgba(254,209,0,.22)" : "rgba(82,116,217,.18)";
---

<PageLayout title={`${project.title} | Proyectos | Mundos Virtuales`}>
  <section class="hero">
    <div class="container">
      <a class="back" href="/proyectos">← Volver a Proyectos</a>

      <div class="wrap card" data-reveal>
        <div class="media">
          <img src={project.cover ?? "/img/projects/placeholder.jpg"} alt={project.title} />
        </div>
        <div class="body">
          <div class="top">
            <span class="chip" style={`background:${chipBg}; border:1px solid rgba(0,0,0,.08);`}>
              {project.area === "automatizacion" ? "Automatización" : "Gestión del efectivo"}
            </span>
            {project.year && <span class="yr">{project.year}</span>}
          </div>

          <h1>{project.title}</h1>
          <p class="p">{project.summary}</p>

          {project.bullets && (
            <ul class="list">
              {project.bullets.map(b => <li>{b}</li>)}
            </ul>
          )}

          <div class="tags">
            {project.tags.map(t => <span class="tag">{t}</span>)}
          </div>

          <div class="actions">
            <a class={"btn " + (tone === "yellow" ? "btn-yellow" : "btn-blue")} href="/#contacto">COTIZAR</a>
            <a class="btn" href="/#contacto">HABLAR CON UN EXPERTO</a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <FooterMV />

  <script>
    import { mountReveal } from "../../scripts/reveal";
    mountReveal();
  </script>

  <style>
    .hero{ padding: 28px 0 40px 0; }
    .back{ display:inline-block; margin-bottom: 12px; font-weight:900; color: rgba(13,13,13,.7); }
    .wrap{ overflow:hidden; }
    .media{ height: min(380px, 44vh); background: rgba(0,0,0,.04); }
    .media img{ width:100%; height:100%; object-fit: cover; }
    .body{ padding: 18px; }
    .top{ display:flex; align-items:center; justify-content:space-between; gap:10px; margin-bottom:10px; }
    .yr{ font-weight:900; color: rgba(13,13,13,.55); }
    h1{
      margin:0 0 10px 0;
      font-size: clamp(1.7rem, 2.6vw, 2.4rem);
      line-height:1.05;
      letter-spacing:.2px;
      font-weight: 900;
    }
    .list{ margin: 12px 0 0 18px; color: rgba(13,13,13,.78); line-height:1.65; font-weight:700; }
    .tags{ display:flex; flex-wrap:wrap; gap:8px; margin-top: 14px; }
    .tag{
      font-size:.82rem;
      padding:.25rem .55rem;
      border-radius:999px;
      border:1px solid rgba(0,0,0,.10);
      background: rgba(0,0,0,.03);
      font-weight: 700;
      color: rgba(13,13,13,.72);
    }
    .actions{ display:flex; flex-wrap:wrap; gap:10px; margin-top: 14px; }
  </style>
</PageLayout>
